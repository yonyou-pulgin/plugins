(()=>{var e={3722:(e,t,a)=>{"use strict";a.d(t,{Zl:()=>n,cS:()=>l,jt:()=>i});var r=a(6537);console.log({NODE_ENV:"production",BASE_URL:""});const o=new r.A({baseURL:{NODE_ENV:"production",BASE_URL:""}.VUE_APP_API_URL||"https://www.yygongzi.com/",timeout:18e4}),n=e=>o.post("feishuapi/bitable/confirm/create",e),i=e=>o.post("feishuapi/bitable/confirm/preview",e),l=e=>o.post("feishuapi/bitable/confirm/update",e)},996:(e,t,a)=>{"use strict";a.d(t,{A:()=>M});var r=a(1070),o=a(8190),n=a(7958),i=(a(3722),a(3759));const l={Text:1,Number:2,SingleSelect:3,MultiSelect:4,DateTime:5,Checkbox:7,User:11,Phone:13,Url:15,Attachment:17,SingleLink:18,Lookup:19,Formula:20,DuplexLink:21,Location:22,GroupChat:23,CreatedTime:1001,ModifiedTime:1002,CreatedUser:1003,ModifiedUser:1004,AutoNumber:1005,Barcode:99001,Progress:99002,Currency:99003,Rating:99004,Email:99005},s=e=>{const t=e.filter((e=>e.name.indexOf("签字人")>-1||e.name.indexOf("签字确认结果")>-1||e.name.indexOf("签字状态")>-1||e.name.indexOf("签字二维码【发给签字人员】")>-1||e.name.indexOf("自动化签字链接")>-1||e.name.indexOf("签字确认结果")>-1||e.name.indexOf("签字确认")>-1)).map((e=>+e.name.replace(/\D/g,"")));let a=Math.max(...t);w.value=a?++a:0},c=(0,r.KR)(!1),d=(0,r.KR)(null),u=(0,r.KR)([]),m=(0,r.KR)(""),g=(0,r.KR)([]),p=(0,r.KR)([]),f=(0,r.KR)(""),v=(0,r.KR)(""),y=(0,r.KR)([]),b=(0,r.KR)(null),h=((0,r.KR)(!1),(0,r.KR)([])),w=(0,r.KR)(0),F=n.UV.base,A=(n.UV.ui,n.UV.bridge,e=>F.getTable(e));const I=async(e,t="")=>{e.tableId||(e.tableId=e.id),d.value=e;const a=await A(e.tableId);t||T(e.tableId),E(e.tableId),S(e.tableId),x(e.tableId),k(),O(),a.onFieldAdd((e=>{console.log("add tableId:"+d.value.tableId),S(d.value.tableId),x(d.value.tableId)})),a.onFieldDelete((e=>{console.log("del tableId:"+d.value.tableId),S(d.value.tableId),x(d.value.tableId)})),n.UV.base.onSelectionChange((e=>{(0,o.dY)((()=>{y.value=[],E(d.value.tableId),x(d.value.tableId)}))}))},E=async e=>{const t=await F.getTableMetaList();t.map((e=>(e.label=e.name,e.value=e.id,e))),u.value=t},T=async e=>{const t=await A(e),a=await t.getName();m.value=a||""},S=async e=>{const t=await A(e),a=await t.getViewMetaList(),r=a.find((e=>1==e.type));if(!r)return;const o=r.id,n=await t.getViewById(o),i=await n.getFieldMetaList();g.value=i.map((e=>(e.label=e.name,e.value=e.id,e)))},x=async e=>{if(c.value)return;c.value=!0;const t=await F.getTableById(e);let a={pageSize:5e3};b.value&&(a.pageToken=b.value);const r=await t.getRecords(a);c.value=!1,r.pageToken?(b.value=r.pageToken,setTimeout((()=>{x(e)}),1e3)):b.value=null,r.pageToken?y.value=y.value.concat(r.records):y.value=r.records},B=async(e,t="")=>new Promise((async(a,o)=>{const n=await F.getTableById(e);let i=(0,r.ux)(y.value);"preview"==t&&(i=[i[0]]);const l=await R(n,i),s=await L(n,l);a(s)})),C=async(e,t,a,r)=>{let o=[];for(const i in r.fields)t==i&&r.fields[i]&&r.fields[i].map((e=>{o.push(e.token)}));const n=await e.getCellAttachmentUrls(o,t,a);return n&&o.length?(r[t]=n,Promise.resolve(r)):Promise.resolve(r)},P=async e=>{const t=await F.getTableById(e);return h.value=await t.getFieldListByType(l.Attachment),h.value},R=async(e,t)=>{const a=(0,r.ux)(h.value);return t.map((t=>{t.PromiseFun=[];const r=t.recordId;a.map((a=>{t.PromiseFun.push(C(e,a.id,r,t))}))})),Promise.resolve(t)},L=async(e,t)=>new Promise((async(e,a)=>{for(const r of t){const e=await Promise.all(r.PromiseFun);delete r.PromiseFun;let t=Object.keys(e[0]);for(let a in r.fields)t.includes(a)&&r.fields[a]&&r.fields[a].map(((t,r)=>{t.attachmentUrl=e[0][a][r]||""}))}e(t)})),k=async()=>{const e=await n.UV.bridge.getTenantKey();f.value=e},O=async()=>{const e=await n.UV.bridge.getUserId();v.value=e},D=async e=>(window.tableInstance||(window.tableInstance=await A(e)),window.tableInstance),U=async(e,t,a,r="签字确认结果",o="")=>new Promise((async(n,i)=>{const s=[],c=await D(e),d=w.value||0;let u=d?`${r}${d}`:`${r}`;const m=await c.addField({type:l.Url,name:u,description:{content:o,disableSyncToFormDesc:!1}});n({viewFieldId:m});const g=await c.getField(m),p=await c.getRecordIdList();let f="签字确认结果"==r?"查看签字结果":"在线签字确认";p.forEach((e=>{a.includes(e)&&s.push({recordId:e,fields:{[g.id]:[{type:"url",text:f,link:`${t}&recordId=${e}`}]}})})),await c.setRecords(s)})),N=async e=>{const t=await n.UV.base.batchUploadFile([e]);return t},_=async(e,t,a)=>{const r=await(0,i.urltoBlob)(t),o=new File([r],"imgage.png",{type:r.type}),n=await N(o),s=[];return new Promise((async(t,r)=>{const i=await D(e),c=w.value||0;let d=c?`签字二维码【发给签字人员】${c}`:"签字二维码【发给签字人员】";const u=await i.addField({type:l.Attachment,name:d});t({qrFieldId:u});const m=await i.getField(u),g=await i.getRecordIdList();g.forEach((e=>{a.includes(e)&&s.push({recordId:e,fields:{[m.id]:[{name:o.name,size:o.size,type:o.type,token:n[0],timeStamp:o.lastModified,permission:{}}]}})})),i.setRecords(s)}))},H=async(e,t,a="签字确认结果",r="")=>new Promise((async(o,n)=>{const i=await D(e),s=w.value||0;let c=s?`${a}${s}`:a;const d=await i.addField({type:l.Formula,name:c,description:{content:r,disableSyncToFormDesc:!1}});o({viewFieldId:d});const u=await i.getField(d);let m=t+"&recordId="||0,g="签字确认结果"==a?"查看签字结果":"在线签字确认",p=`HYPERLINK(CONCATENATE("${m}",RECORD_ID()),"${g}")`;await u.setFormula(p)})),V=async(e,t,a="自动化签字链接",r=!0)=>new Promise((async(o,n)=>{let i="如何通过飞书自动化推送签字消息https://yygongzi.feishu.cn/docx/EUdEdozAVobHQ2x4YcXcRakTnmh";const s=await D(e),c=w.value||0;let d=c?`${a}${c}`:a;++w.value;const u=await s.addField({type:l.Formula,name:d,description:{content:i,disableSyncToFormDesc:!1}});o({viewFieldId:u});const m=await s.getField(u);let g=t+"&recordId="||0,p="";p=r?`CONCATENATE("${g}", RECORD_ID())`:`CONCATENATE("${g}&rowId=", RECORD_ID())`,await m.setFormula(p)})),K=async(e,t,a)=>new Promise((async(t,a)=>{const r=await D(e),o=w.value||0;let n=o?`签字状态${o}`:"签字状态";const i=await r.addField({type:l.SingleSelect,name:n});t({statusFieldId:i,statusFieldName:n});const s=await r.getField(i);await s.addOptions([{name:"未查看/未签字"},{name:"已查看/已签字"},{name:"已查看/未签字"}]);const c=await r.getRecordIdList();c.forEach((e=>{s.setValue(e,"未查看/未签字")}))})),$=async()=>{await n.UV.ui.closeHostContainer()},j=async(e,t,a)=>new Promise((async(r,o)=>{const n=await D(e),i=w.value||0;let s=i?`签字人${i}`:"签字人";const c=await n.addField({type:l.Text,name:s});r({userField:c});await n.getField(t);const d=await n.getRecordList();d.recordIdList.map((async e=>{if(a.includes(e)){let a=await n.getCellValue(t,e);if(Array.isArray(a)&&a[0]){let t=a[0];!t.type&&t.name&&t.id&&(t=Object.assign({type:"mention",mentionType:"User",token:t.id,text:`@${t.name}`},t),a=[t]);const r=await n.getField(c);await r.setValue(e,a)}}}))}));function M(){return{userId:v,tableInfo:d,tableName:m,sheetList:u,fieldList:g,recordList:p,tenantKey:f,tableData:y,attachmentFieldList:h,insetFieldIndex:w,checkHasAttachment:P,getCellList:x,getCellUrlResult:B,getTableSheetList:E,setTableInfo:I,addField:U,addImgField:_,addFormulaField:H,addSingleSelectField:K,closePlugin:$,addFormulaLinkField:V,setUserField:j,findFieldIndex:s}}},2351:(e,t,a)=>{"use strict";var r=a(4299),o=a(8190),n=a(1070),i=a(4772);i.A.Pagination.jump_to="跳转到";const l={token:{fontFamily:'"Helvetica Neue",Helvetica,Arial,"PingFang SC","microsoft yahei","微软雅黑","Arial","sans-serif","黑体"',borderRadius:6,boxShadow:"0px 2px 10px 0 rgba(0,0,0,0.14)",boxShadowSecondary:"0px 2px 10px 0 rgba(0,0,0,0.14)",colorPrimary:"#3a75ff",colorPrimaryActive:"#3A75FF",colorPrimaryTextHover:"#6191FF",colorPrimaryHover:"#6191FF",colorPrimaryBorderHover:"#3A75FF",colorPrimaryBorder:"#3A75FF",colorSuccess:"#11c215",colorSuccessBg:"#F0FBF0",colorSuccessBgHover:"#F0FBF0",colorSuccessBorder:"#34C724",colorSuccessBorderHover:"#34C724",colorSuccessActive:"#11C215",colorSuccessTextHover:"#11C215",colorSuccessText:"#11C215",colorSuccessTextActive:"#11C215",colorError:"#FD3B3A",colorErrorBg:"#FEEBEB",colorErrorBgHover:"#FEEBEB",colorErrorBorder:"#FD3B3A",colorErrorBorderHover:"#FD3B3A",colorErrorHover:"#FD3B3A",colorErrorActive:"#FD3B3A",colorErrorTextHover:"#FD3B3A",colorErrorText:"#FD3B3A",colorErrorTextActive:"#FD3B3A",colorInfo:"#3a75ff",colorTextBase:"#333333",colorBgMask:"rgba(0, 0, 0, 0.5)",colorTextHeading:"#333333",colorText:"#333333",marginXXS:2,marginXS:4,marginSM:6,margin:8,marginMD:12,marginLG:16,marginXL:20,marginXXL:24,paddingXXS:12,paddingXS:12,padding:12,paddingMD:12,paddingLG:12,paddingXL:12,wireframe:!1,colorBorder:"#D6DAE4",controlHeight:32,colorBgSpotlight:"rgba(51,51,51,0.9)",colorWarning:"#FB952A",fontWeightStrong:500},components:{Modal:{}}},s={locale:i.A,theme:l};var c=a(7226),d=a(3716),u=a(7958),m=a(996);a(3759);const g={__name:"App",setup(e){const{setTableInfo:t}=(0,m.A)(),a=async()=>{const e=await u.UV.base.getSelection();t(e)};return a(),(e,t)=>{const a=(0,o.g2)("a-style-provider"),r=(0,o.g2)("a-config-provider");return(0,o.uX)(),(0,o.Wv)(r,{theme:(0,n.R1)(s).theme,locale:(0,n.R1)(s).locale},{default:(0,o.k6)((()=>[(0,o.bF)(a,{"hash-priority":"high",transformers:[(0,n.R1)(c.A)]},{default:(0,o.k6)((()=>[(0,o.bF)((0,n.R1)(d.Tp))])),_:1},8,["transformers"])])),_:1},8,["theme","locale"])}}},p=g,f=p;var v=a(5686);const y={title:"title"},b={title:"标题"},h=(0,v.hU)({locale:"en",allowComposition:!0,messages:{en:y,zh:b}});u.UV.bridge.getLanguage().then((e=>{h.global.locale=e}));const w=(0,d.aE)({history:(0,d.Bt)("/"),routes:[{path:"/",name:"createForm",component:()=>Promise.all([a.e(641),a.e(165)]).then(a.bind(a,9441))},{path:"/success",name:"success",component:()=>Promise.all([a.e(641),a.e(306)]).then(a.bind(a,3641))}]}),F=w;var A=a(2713);a(757);(0,r.Ef)(f).use(A.Ay).use(F).use(h).mount("#app")},3936:()=>{}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=e,(()=>{var e=[];a.O=(t,r,o,n)=>{if(!r){var i=1/0;for(d=0;d<e.length;d++){for(var[r,o,n]=e[d],l=!0,s=0;s<r.length;s++)(!1&n||i>=n)&&Object.keys(a.O).every((e=>a.O[e](r[s])))?r.splice(s--,1):(l=!1,n<i&&(i=n));if(l){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[r,o,n]}})(),(()=>{a.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return a.d(t,{a:t}),t}})(),(()=>{a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,r)=>(a.f[r](e,t),t)),[]))})(),(()=>{a.u=e=>"static/js/"+e+"."+{165:"95ed2a51",306:"3f350423",344:"72e848a9",641:"bf82894f"}[e]+".js"})(),(()=>{a.miniCssF=e=>"static/css/"+e+"."+{165:"db5ad66b",306:"43c19969"}[e]+".css"})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="plugins:";a.l=(r,o,n,i)=>{if(e[r])e[r].push(o);else{var l,s;if(void 0!==n)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==t+n){l=u;break}}l||(s=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.setAttribute("data-webpack",t+n),l.src=r),e[r]=[o];var m=(t,a)=>{l.onerror=l.onload=null,clearTimeout(g);var o=e[r];if(delete e[r],l.parentNode&&l.parentNode.removeChild(l),o&&o.forEach((e=>e(a))),t)return t(a)},g=setTimeout(m.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=m.bind(null,l.onerror),l.onload=m.bind(null,l.onload),s&&document.head.appendChild(l)}}})(),(()=>{a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{a.p=""})(),(()=>{if("undefined"!==typeof document){var e=(e,t,r,o,n)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",a.nc&&(i.nonce=a.nc);var l=a=>{if(i.onerror=i.onload=null,"load"===a.type)o();else{var r=a&&a.type,l=a&&a.target&&a.target.href||t,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+": "+l+")");s.name="ChunkLoadError",s.code="CSS_CHUNK_LOAD_FAILED",s.type=r,s.request=l,i.parentNode&&i.parentNode.removeChild(i),n(s)}};return i.onerror=i.onload=l,i.href=t,r?r.parentNode.insertBefore(i,r.nextSibling):document.head.appendChild(i),i},t=(e,t)=>{for(var a=document.getElementsByTagName("link"),r=0;r<a.length;r++){var o=a[r],n=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(n===e||n===t))return o}var i=document.getElementsByTagName("style");for(r=0;r<i.length;r++){o=i[r],n=o.getAttribute("data-href");if(n===e||n===t)return o}},r=r=>new Promise(((o,n)=>{var i=a.miniCssF(r),l=a.p+i;if(t(i,l))return o();e(r,l,null,o,n)})),o={524:0};a.f.miniCss=(e,t)=>{var a={165:1,306:1};o[e]?t.push(o[e]):0!==o[e]&&a[e]&&t.push(o[e]=r(e).then((()=>{o[e]=0}),(t=>{throw delete o[e],t})))}}})(),(()=>{var e={524:0};a.f.j=(t,r)=>{var o=a.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else if(306!=t){var n=new Promise(((a,r)=>o=e[t]=[a,r]));r.push(o[2]=n);var i=a.p+a.u(t),l=new Error,s=r=>{if(a.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var n=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;l.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",l.name="ChunkLoadError",l.type=n,l.request=i,o[1](l)}};a.l(i,s,"chunk-"+t,t)}else e[t]=0},a.O.j=t=>0===e[t];var t=(t,r)=>{var o,n,[i,l,s]=r,c=0;if(i.some((t=>0!==e[t]))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(s)var d=s(a)}for(t&&t(r);c<i.length;c++)n=i[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},r=self["webpackChunkplugins"]=self["webpackChunkplugins"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{a.nc=void 0})();var r=a.O(void 0,[504],(()=>a(2351)));r=a.O(r)})();
//# sourceMappingURL=app.0a5a6543.js.map